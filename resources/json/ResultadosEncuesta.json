{
	"$schema": "https://vega.github.io/schema/vega-lite/v2.json",
	"title": "TITULO GENERAL DE LA VIZ EN VEGA-LITE",	
	"data": { "url": "https://raw.githubusercontent.com/jairoruizsaenz/FPS_ResultadosEncuestas/master/resources/data/_data_.csv","format": {"type": "csv"}},

	"hconcat": [
	  	{
	  		"vconcat": [
				{
					"title": "TITULO - Gráfica 1","mark": "bar","width": 190,
					"selection": {"click": {"encodings": ["color"], "type": "multi"}},
					"encoding": {
					
						"color": {
							"condition": {"field": "DIVISION","selection": "click","type": "nominal"},
							"value": "lightgray"
						},
												
						"x": {"aggregate": "count","field": "ID","type": "quantitative","title": "Título_X"},
						"y": {"field": "DIVISION", "type": "nominal","title": "Título_Y"},

						"tooltip": [						
								{"field": "DIVISION","type": "nominal","title": "División"},
								{"field": "ID","type": "quantitative","title": "# encuestas","aggregate": "count"}
						]					
					}			
			  	},			  	
			  	{
					"title": "TITULO - Gráfica 2A","mark": "bar","width": 190,
					"selection": {"click": {"encodings": ["color"], "type": "multi"}},
					"encoding": {
					
						"color": {
							"condition": {"field": "ANHO","selection": "click","type": "nominal"},
							"value": "lightgray"
						},
						
						"x": {"aggregate": "count","field": "ID","type": "quantitative","title": "Título_X"},
						"y": {"field": "ANHO", "type": "nominal","title": "Título_Y"},						

						"tooltip": [								
								{"field": "ANHO","type": "nominal","title": "Año"},
								{"field": "ID","type": "quantitative","title": "# encuestas","aggregate": "count","format": ",.0f"}
						]					
					}					
			  	},
			  	{
					"title": "TITULO - Gráfica 2B","mark": "bar","width": 190,
					"selection": {"click": {"encodings": ["color"], "type": "multi"}},
					"encoding": {
					
						"color": {
							"condition": {"field": "TRIMESTRE","selection": "click","type": "nominal"},
							"value": "lightgray"
						},
						
						"x": {"aggregate": "count","field": "ID","type": "quantitative","title": "Título_X"},
						"y": {"field": "ANHO", "type": "nominal","title": "Título_Y"},						

						"tooltip": [								
								{"field": "TRIMESTRE","type": "nominal","title": "Trimestre"},
								{"field": "ID","type": "quantitative","title": "# encuestas","aggregate": "count"}
						]					
					}					
			  	}
			]
		},
		{
			"vconcat": [
				{
					"title": "¿EL TRATO QUE RECIBIO EN LA ATENCIÓN FUE?","mark": "bar","width": 60,
					
					  "encoding": {
					    "column": {
					      "field": "PREGUNTA_01", "type": "nominal"
					    },
					    "y": {
					      "aggregate": "count", "field": "ID", "type": "quantitative", "as": "test",
					      "axis": {"title": "population", "grid": false}
					    },
					    "x": {
					      "field": "ANHO", "type": "nominal",					      
					      "axis": {"title": " "}
					    },

						    "color": {
						      "field": "ANHO", "type": "nominal"
						    },

					    "tooltip": [
					    		{"field": "ANHO","type": "nominal","title": "Año"},
								{"field": "PREGUNTA_01","type": "nominal","title": "Respuesta"},
								{"field": "ID","type": "quantitative","title": "# encuestas","aggregate": "count","format": ",.0f"},
								{"field": "PREGUNTA_01_TOTAL", "type": "quantitative", "title": "# total de encuestas","format": ",.0f"},
								{"field": "PercentOfTotal", "type": "quantitative", "title": "% de votos","format": ",.0f"}
						]
					  },
					  
					"transform": [
						{"filter": {"selection": "click"}},
						{"window": [{"op": "count","field": "PREGUNTA_01","as": "PREGUNTA_01_TOTAL"}],
								"groupby": ["ANHO"],
								"frame": [null, null]
						},
						{
							"calculate": "datum.PREGUNTA_01_TOTAL * 1000",
							"as": "PercentOfTotal"
						}
					]
			  	},			  	
			  	{
					"title": "¿EL TRATO QUE RECIBIO EN LA ATENCIÓN FUE? 3","mark": "bar","width": 60,
					
					  "encoding": {
					    "column": {
					      "field": "PREGUNTA_03", "type": "nominal"
					    },
					    "y": {
					      "aggregate": "count", "field": "ID", "type": "quantitative", "as": "test",
					      "axis": {"title": "population", "grid": false}
					    },
					    "x": {
					      "field": "ANHO", "type": "nominal",					      
					      "axis": {"title": ""}
					    },

						    "color": {
						      "field": "ANHO", "type": "nominal"
						    },

					    "tooltip": [
					    		{"field": "ANHO","type": "nominal","title": "Año"},
								{"field": "PREGUNTA_03","type": "nominal","title": "Respuesta"},
								{"field": "ID","type": "quantitative","title": "# encuestas","aggregate": "count","format": ",.0f"},
								{"field": "PREGUNTA_03_TOTAL", "type": "quantitative", "title": "# total de encuestas","format": ",.0f"},
								{"field": "PercentOfTotal", "type": "quantitative", "title": "% de votos","format": ",.0f"}
						]
					  },
					  
					"transform": [
						{"filter": {"selection": "click"}},
						{"window": [{"op": "count","field": "PREGUNTA_03","as": "PREGUNTA_03_TOTAL"}],
								"groupby": ["ANHO"],
								"frame": [null, null]
						},
						{
							"calculate": "datum.PREGUNTA_03_TOTAL * 1000",
							"as": "PercentOfTotal"
						}
					]
			  	}
			]
		},
		{
			"vconcat": [			  	
			  	{
					"title": "¿EL TRATO QUE RECIBIO EN LA ATENCIÓN FUE?","mark": "bar","width": 60,
					
					  "encoding": {
					    "column": {
					      "field": "PREGUNTA_01", "type": "nominal"
					    },
					    "y": {
					      "aggregate": "count", "field": "ID", "type": "quantitative", "as": "test",
					      "axis": {"title": "population", "grid": false}
					    },
					    "x": {
					      "field": "ANHO", "type": "nominal",					      
					      "axis": {"title": ""}
					    },

						    "color": {
						      "field": "ANHO", "type": "nominal"
						    },

					    "tooltip": [
					    		{"field": "ANHO","type": "nominal","title": "Año"},
								{"field": "PREGUNTA_01","type": "nominal","title": "Respuesta"},
								{"field": "ID","type": "quantitative","title": "# encuestas","aggregate": "count","format": ",.0f"},
								{"field": "PREGUNTA_01_TOTAL", "type": "quantitative", "title": "# total de encuestas","format": ",.0f"},
								{"field": "PercentOfTotal", "type": "quantitative", "title": "% de votos","format": ",.0f"}
						]
					  },
					  
					"transform": [
						{"filter": {"selection": "click"}},
						{"window": [{"op": "count","field": "PREGUNTA_01","as": "PREGUNTA_01_TOTAL"}],
								"groupby": ["ANHO"],
								"frame": [null, null]
						},
						{
							"calculate": "datum.PREGUNTA_01_TOTAL * 1000",
							"as": "PercentOfTotal"
						}
					]
			  	}
			]
		}		
	]
}